---
import BaseLayout from "../layouts/BaseLayout.astro";

const toEmail = "rhisolutions316@gmail.com";

const service = Astro.url.searchParams.get("service") ?? "";
const location = Astro.url.searchParams.get("location") ?? "";
---

<BaseLayout
  title="Request a Quote | Revision Home Improvements (Lehigh Valley, PA)"
  description="Request a quote for remodeling, repairs, or flooring in the Lehigh Valley, PA. Share a few details and we’ll reply within 24–48 hours."
>
  <section class="wrap section" style="padding-top: 0;">
    <div class="card">
      <h1>Request a Quote</h1>
      <p class="muted" style="margin-top:0;">
        We aim to reply within <strong>24–48 hours</strong>. Your request will be sent to <strong>{toEmail}</strong>.
        <br />
        <span class="muted">No spam—just a fast follow-up about your project.</span>
      </p>

      <!--
        NOTE: This form posts to /api/quote (Netlify/Vercel/etc).
        We'll wire it up once hosting is chosen.
      -->
      <div class="quote-grid">
        <div class="quote-help">
          <div class="help-card">
            <h2>What to include</h2>
            <ul>
              <li>Project type and priority</li>
              <li>City + ZIP (service area)</li>
              <li>Any urgency concerns</li>
              <li>Photos (optional)</li>
            </ul>
          </div>
          <div class="help-card">
            <h2>What happens next</h2>
            <ol>
              <li>We review your details and confirm scope fit.</li>
              <li>We contact you for a quick discovery call.</li>
              <li>You get a clear next-step plan for estimate and scheduling.</li>
            </ol>
          </div>
        </div>

        <form method="post" action="/api/quote" class="quote-form">
        <input type="hidden" name="lead_source" value="website" />

        <div class="grid">
          <label>
            Name
            <input name="name" autocomplete="name" required />
          </label>
          <label>
            Phone (best)
            <input name="phone" type="tel" inputmode="tel" autocomplete="tel" required placeholder="(484) 555-1234" />
          </label>
          <label>
            Email
            <input name="email" type="email" autocomplete="email" required placeholder="you@example.com" />
          </label>
          <label>
            ZIP
            <input name="zip" inputmode="numeric" autocomplete="postal-code" value={location} placeholder="e.g., 18015" />
          </label>
          <label>
            City
            <input name="city" autocomplete="address-level2" placeholder="e.g., Bethlehem" />
          </label>
          <label>
            Service
            <select name="service" value={service}>
              <option value="">Select…</option>
              <option value="Kitchen Remodeling" selected={service === "Kitchen Remodeling"}>Kitchen Remodeling</option>
              <option value="Bathroom Remodeling" selected={service === "Bathroom Remodeling"}>Bathroom Remodeling</option>
              <option value="Basement Finishing" selected={service === "Basement Finishing"}>Basement Finishing</option>
              <option value="Drywall Installation and Repair" selected={service === "Drywall Installation and Repair"}>Drywall Installation & Repair</option>
              <option value="Flooring Installation" selected={service === "Flooring Installation"}>Flooring Installation</option>
              <option value="Water Damage Restoration" selected={service === "Water Damage Restoration"}>Water Damage Restoration</option>
            </select>
          </label>
          <label>
            Timeline
            <input name="timeline" placeholder="e.g., ASAP / 2–4 weeks / flexible" />
          </label>
          <label>
            Preferred contact
            <select name="preferred_contact">
              <option value="">No preference</option>
              <option value="Call">Call</option>
              <option value="Text">Text</option>
              <option value="Email">Email</option>
            </select>
          </label>
        </div>

        <label>
          Project details
          <textarea
            name="message"
            rows="6"
            required
            placeholder="What do you want done? Any measurements? What’s the goal?"
          ></textarea>
        </label>

        <label>
          Photos (optional)
          <input name="photos" type="file" accept="image/*" multiple />
          <span class="muted" style="font-weight:600; font-size: 14px;">If file upload isn’t supported on your device, just submit without photos and we’ll follow up.</span>
        </label>

        <div class="row">
          <button class="btn" type="submit">Send Request</button>
          <a class="btn btn-outline" href="/">Back to Home</a>
        </div>

        <div class="fineprint muted">
          Prefer to talk it through? Call us and we’ll get you on the schedule.
        </div>
        </form>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  h1 { margin: 0 0 10px; }
  h2 { margin: 0 0 10px; font-size: 18px; }

  .quote-grid {
    display: grid;
    grid-template-columns: 1fr 1.1fr;
    gap: 16px;
    align-items: start;
    margin-top: 16px;
  }

  .help-card {
    background: rgba(18,24,38,0.55);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 14px;
    margin-bottom: 12px;
  }
  .help-card ul, .help-card ol { margin: 0; padding-left: 18px; color: var(--muted); }
  .help-card li { margin: 6px 0; }

  label { display: grid; gap: 6px; margin: 12px 0; font-weight: 700; }
  input, textarea, select {
    background: rgba(255,255,255,0.04);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 12px;
    color: var(--text);
    font: inherit;
  }

  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px; }

  .fineprint { margin-top: 14px; }

  @media (max-width: 900px) {
    .quote-grid { grid-template-columns: 1fr; }
  }
  @media (max-width: 720px) {
    .grid { grid-template-columns: 1fr; }
  }
</style>
